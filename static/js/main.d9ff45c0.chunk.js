(this["webpackJsonpguestbook-frontend"]=this["webpackJsonpguestbook-frontend"]||[]).push([[0],{20:function(e,t,a){e.exports=a(48)},25:function(e,t,a){},26:function(e,t,a){},45:function(e,t,a){e.exports=a.p+"static/media/edit.fb6f5682.png"},46:function(e,t,a){e.exports=a.p+"static/media/delete.f1782b1c.webp"},48:function(e,t,a){"use strict";a.r(t);var n,r,s=a(0),o=a.n(s),c=a(19),i=a.n(c),l=(a(25),a(1)),m=a(2),u=a(4),p=a(3),d=(a(26),function(e){var t=localStorage.getItem(localStorage.key(e));return JSON.parse(t)}),b=function(e){localStorage.removeItem(e)},h=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).onSignoutClick=function(){(0,e.props.changeRoute)("login"),b("userInfo")},e}return Object(m.a)(a,[{key:"render",value:function(){var e,t,a=this.props,n=a.isSignedin,r=a.changeRoute,s=null===(e=d("userInfo"))||void 0===e||null===(t=e.userData)||void 0===t?void 0:t.username;return o.a.createElement(o.a.Fragment,null,n?o.a.createElement("nav",{className:"dt w-100 border-box pa3 ph5-ns bg-black-80 white"},o.a.createElement("div",{className:"dtc v-mid w-75 tr"},o.a.createElement("p",{className:"link f3-ns dib mr2",title:"Contact"},"Hi, ",s),o.a.createElement("p",{onClick:this.onSignoutClick,className:"link dim f3-ns dib pointer mr2 ml4",title:"Contact"},"Signout"))):o.a.createElement("nav",{className:"dt w-100 border-box pa3 ph5-ns bg-black-80 white"},o.a.createElement("div",{className:"dtc v-mid w-75 tr"},o.a.createElement("p",{onClick:function(){return r("login")},className:"link dim f3-ns dib mr3 mr4-ns pointer",title:"Store"},"Login"),o.a.createElement("p",{onClick:function(){return r("register")},className:"link dim f3-ns dib pointer mr2",title:"Contact"},"Register"))))}}]),a}(o.a.Component),g=a(7),f=a.n(g),v=a(9),w=a(6),E=a.n(w),k=function(){var e=Object(v.a)(f.a.mark((function e(t,a){var n,r,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d("userInfo");case 2:return n=e.sent,r=n.token,s={"Content-Type":"application/json","user-token":"".concat(r)},e.next=7,E.a.post("https://cryptic-meadow-98283.herokuapp.com".concat(t),a,{headers:s});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),N=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).onTextareaChange=function(t){e.setState({messageContent:t.target.value})},e.clearInput=function(){document.getElementById("writeMessage").value=""},e.onFormSubmit=function(t){var a=e.state.messageContent,n=e.props.reloadHome;t.preventDefault(),k("/api/messages/add",{content:a}).then((function(){e.setState({messageContent:""}),e.clearInput(),n()})).catch((function(e){return console.log("err:",e)}))},e.state={messageContent:""},e}return Object(m.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"pt2"},o.a.createElement("form",{className:"bg-white mw7 center pa2 br1-ns ba b--black-10",onSubmit:this.onFormSubmit},o.a.createElement("fieldset",{className:"cf bn ma0 pa0"},o.a.createElement("div",{className:"cf"},o.a.createElement("textarea",{onChange:this.onTextareaChange,className:"f3 input-reset bn fl black-80 bg-white pt2 lh-solid w-80 w-80-m w-80-l br2-ns outline-0",placeholder:"Add a Message ..",type:"text",name:"addMessage",id:"writeMessage",style:{resize:"none"},required:!0}),o.a.createElement("input",{className:"f5 f3-l button-reset fr pv3 tc bn bg-animate bg-blue grow white pointer w-50 w-20-m w-20-l br4-ns outline-0",type:"submit",value:"Message"})))))}}]),a}(o.a.Component),y=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this,t=this.props.comment,a=t.owner,n=t.content;return o.a.createElement("div",{className:"bg-black-20 br3 tl ph3 pa2 pb0 w-80 ml4"},o.a.createElement("p",{onClick:function(){return e.showProfile(a)},className:"f4 pb0 mb3 mt2 pointer hover-black-70 dark-blue dib"},a),o.a.createElement("p",{className:"pt0 mt0 ml4 f4"},n))}}]),a}(o.a.Component),C=function(){var e=Object(v.a)(f.a.mark((function e(t,a){var n,r,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d("userInfo");case 2:return n=e.sent,r=n.token,s={"Content-Type":"application/json","user-token":"".concat(r)},e.next=7,E.a.put("https://cryptic-meadow-98283.herokuapp.com".concat(t),a,{headers:s});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),j=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).onCommentClick=function(){var t=e.state.commentContent,a=e.props.reloadHome,n={content:t};C("/api/messages/comment/".concat(e.props._id),n).then((function(t){a(),e.setState({commentContent:""}),document.getElementById("commentContent").value=""})).catch((function(e){return console.log(e)}))},e.onCommentChange=function(t){e.setState({commentContent:t.target.value})},e.state={commentContent:""},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this.props._id;return o.a.createElement("div",{className:"bg-white mw6 center pa2 br4-ns ba b--white",id:"commentBlock".concat(e)},o.a.createElement("fieldset",{className:"cf bn ma0 pa0"},o.a.createElement("div",{className:"cf"},o.a.createElement("textarea",{onChange:this.onCommentChange,className:"f4 input-reset bn fl black-80 bg-white pt2 lh-solid w-60 w-60-m w-60-l br2-ns outline-0",id:"commentContent",placeholder:"Write a comment..",type:"text",name:"message",style:{resize:"none"}}),o.a.createElement("input",{onClick:this.onCommentClick,className:"f6 f5-l button-reset fr pv3 tc bn bg-animate bg-blue grow white pointer w-30 w-20-m w-20-l br4-ns outline-0",type:"submit",value:"Comment"}))))}}]),a}(o.a.Component),O=function(e){Object(u.a)(n,e);var t=Object(p.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){return o.a.createElement("img",{src:a(45),className:"h2 w2 dib pointer dim fl",alt:"edit"})}}]),n}(o.a.Component),S=function(e){Object(u.a)(n,e);var t=Object(p.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){return o.a.createElement("img",{src:a(46),className:"h2 w2 dib pointer dim fr",alt:"edit"})}}]),n}(o.a.Component),M=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e,t,a=this.props.message,n=a.username,r=a.content,s=a.comments,c=a._id,i=this.props.reloadHome,l=null===(e=d("userInfo"))||void 0===e||null===(t=e.userData)||void 0===t?void 0:t.username;return o.a.createElement("article",{className:"w-100 center bg-white br4 pa3 pa3-ns mv3 ba b--black-40 pb0 pb0-ns"},o.a.createElement("div",{className:"tc"},n===l?o.a.createElement("section",null,o.a.createElement(O,null),o.a.createElement(S,null)):null,o.a.createElement("p",{className:"f3"},n),o.a.createElement("hr",{className:"mw3 bb bw1 b--black-10"})),o.a.createElement("p",{className:"lh-copy measure center f3 black-70"},r),o.a.createElement("hr",{className:"bb bw1 b--black-10"}),o.a.createElement(j,{_id:c,reloadHome:i}),s.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement(y,{comment:e}))})))}}]),a}(o.a.Component),I=function(e){var t=d("userInfo").token,a={"Content-Type":"application/json","user-token":"".concat(t)};return E.a.get("https://cryptic-meadow-98283.herokuapp.com".concat(e),{headers:a})},R=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){var e=n.props.changeRoute;I("/api/messages/list").then((function(e){n.setState({messages:e.data})})).catch((function(t){e("login")}))},n.state={messages:[]},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this,t=this.state.messages;return o.a.createElement("main",{className:"tc mw7 center avenir"},o.a.createElement("section",{className:"ma4"},o.a.createElement(N,{reloadHome:this.componentDidMount}),t.length?t.map((function(t,a){return o.a.createElement("div",{key:a},o.a.createElement(M,{message:t,reloadHome:e.componentDidMount}))})):o.a.createElement("h1",null,"Loading...")))}}]),a}(o.a.Component),x=a(8),P=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).validateUser=function(){var e=n.state,t=e.password,a=e.confirmPassword;return e.username?t?t.length<6?(n.setState({errorMessage:"Password length must be 6 or more!"}),!1):t===a||(n.setState({errorMessage:"Password confirmation doesn't match password"}),!1):(n.setState({errorMessage:"Password is required!"}),!1):(n.setState({errorMessage:"Username is required!"}),!1)},n.onInputChange=function(e){var t;n.setState((t={},Object(x.a)(t,e.target.name,e.target.value),Object(x.a)(t,"errorMessage",""),t))},n.onFormSubmit=function(e){var t,a=n.props.changeRoute,r=n.state,s=r.username,o=r.password;e.preventDefault(),n.validateUser()&&(t={username:s,password:o},console.log(t),E.a.post("https://cryptic-meadow-98283.herokuapp.com/api/users/register",t)).then((function(e){e.data._id&&a("login")})).catch((function(e){e.response.data.msg?n.setState({errorMessage:e.response.data.msg}):n.setState({errorMessage:"an error occurred please try again later!"})}))},n.state={username:"",password:"",confirmPassword:"",errorMessage:""},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this.props.changeRoute,t=this.state.errorMessage;return o.a.createElement("main",{className:"pa4 black-80"},o.a.createElement("form",{className:"measure center",onSubmit:this.onFormSubmit},o.a.createElement("fieldset",{id:"sign_up",className:"ba b--transparent ph0 mh0"},o.a.createElement("legend",{className:"f3 fw6 ph0 mh0"},"Register"),o.a.createElement("span",{className:"red"},t),o.a.createElement("div",{className:"mt3"},o.a.createElement("label",{className:"db fw6 lh-copy f6"},"Username"),o.a.createElement("input",{onChange:this.onInputChange,className:"pa2 input-reset ba bg-transparent w-70",type:"name",name:"username"})),o.a.createElement("div",{className:"mv3"},o.a.createElement("label",{className:"db fw6 lh-copy f6"},"Password"),o.a.createElement("input",{onChange:this.onInputChange,className:"pa2 input-reset ba bg-transparent w-75",type:"password",name:"password"})),o.a.createElement("div",{className:"mv3"},o.a.createElement("label",{className:"db fw6 lh-copy f6"},"Confirm Password"),o.a.createElement("input",{onChange:this.onInputChange,className:"pa2 input-reset ba bg-transparent w-75",type:"password",name:"confirmPassword"}))),o.a.createElement("div",null,o.a.createElement("input",{className:"b ph3 pv2 input-reset ba b--black bg-transparent grow pointer f6 dib",type:"submit",value:"Register"})),o.a.createElement("div",{className:"lh-copy mt3"},"Already have an accout?",o.a.createElement("span",{className:"f6 link blue dim underline pointer ml1",onClick:function(){return e("login")}},"Login"))))}}]),a}(o.a.Component),D=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).validateUser=function(){var e=n.state,t=e.password;return e.username?t?!(t.length<6)||(n.setState({errorMessage:"Password length must be 6 or more!"}),!1):(n.setState({errorMessage:"Password is required!"}),!1):(n.setState({errorMessage:"Username is required!"}),!1)},n.onInputChange=function(e){var t;n.setState((t={},Object(x.a)(t,e.target.name,e.target.value),Object(x.a)(t,"errorMessage",""),t))},n.onFormSubmit=function(e){var t,a=n.props.changeRoute,r=n.state,s=r.username,o=r.password;e.preventDefault(),n.validateUser()&&(t={username:s,password:o},E.a.post("https://cryptic-meadow-98283.herokuapp.com/api/users/login",t)).then((function(e){e.data.auth&&(!function(e){var t=e.key,a=e.data;localStorage.setItem(t,JSON.stringify(a))}({key:"userInfo",data:e.data}),a("home"))})).catch((function(e){e.response.data.msg?n.setState({errorMessage:e.response.data.msg}):n.setState({errorMessage:"an error occurred please try again later!"})}))},n.state={username:"",password:"",errorMessage:""},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this.props.changeRoute,t=this.state.errorMessage;return o.a.createElement("main",{className:"pa4 black-80"},o.a.createElement("form",{className:"measure center",onSubmit:this.onFormSubmit},o.a.createElement("fieldset",{id:"sign_up",className:"ba b--transparent ph0 mh0"},o.a.createElement("legend",{className:"f3 fw6 ph0 mh0"},"Login"),o.a.createElement("span",{className:"red"},t),o.a.createElement("div",{className:"mt3"},o.a.createElement("label",{className:"db fw6 lh-copy f6"},"Username"),o.a.createElement("input",{onChange:this.onInputChange,className:"pa2 input-reset ba bg-transparent w-70",type:"name",name:"username"})),o.a.createElement("div",{className:"mv3"},o.a.createElement("label",{className:"db fw6 lh-copy f6"},"Password"),o.a.createElement("input",{onChange:this.onInputChange,className:"pa2 input-reset ba bg-transparent w-75",type:"password",name:"password"}))),o.a.createElement("div",null,o.a.createElement("input",{className:"b ph3 pv2 input-reset ba b--black bg-transparent grow pointer f6 dib",type:"submit",value:"Login"})),o.a.createElement("div",{className:"lh-copy mt3"},"Dont have an accout yet?",o.a.createElement("span",{className:"f6 link blue dim underline pointer ml1",onClick:function(){return e("register")}},"Register"))))}}]),a}(o.a.Component),F={route:(null===(n=d("userInfo"))||void 0===n?void 0:n.auth)?"home":"login",isSignedin:null===(r=d("userInfo"))||void 0===r?void 0:r.auth},U=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).changeRoute=function(t){e.setState({route:t}),"register"!==t&&window.location.reload()},e.state=F,e}return Object(m.a)(a,[{key:"render",value:function(){var e=this.state,t=e.route,a=e.isSignedin;return o.a.createElement(o.a.Fragment,null,o.a.createElement(h,{changeRoute:this.changeRoute,isSignedin:a}),"login"===t?o.a.createElement(D,{changeRoute:this.changeRoute}):"register"===t?o.a.createElement(P,{changeRoute:this.changeRoute}):o.a.createElement(R,{changeRoute:this.changeRoute}))}}]),a}(s.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(47);i.a.render(o.a.createElement(U,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[20,1,2]]]);
//# sourceMappingURL=main.d9ff45c0.chunk.js.map